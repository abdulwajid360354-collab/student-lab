<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Lab | Ultimate Tools for Students</title>
    <meta name="description" content="All-in-one platform for students. Schedule maker, AI Quiz Maker, Pomodoro timer, CGPA calculator, and PDF Tools.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: { extend: { colors: { primary: '#4F46E5', darkbg: '#111827', darkcard: '#1F2937' } } }
        }
    </script>
    <style>
        body { transition: background-color 0.3s, color 0.3s; }
        .hide { display: none !important; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #4F46E5; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* MCQ Correct/Wrong Colors */
        input[type="radio"]:checked + span { font-weight: bold; color: #4F46E5; }
        .correct-answer { background-color: #d1fae5 !important; border-color: #10b981 !important; color: #065f46 !important; }
        .wrong-answer { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #991b1b !important; }
        
        /* Print Styles for Schedule Maker */
        @media print {
            body * { visibility: hidden; }
            #schedule, #schedule * { visibility: visible; }
            #schedule { position: absolute; left: 0; top: 0; width: 100%; }
            nav, .no-print { display: none !important; }
        }
        
        /* Editable Table Cells */
        td[contenteditable="true"]:focus { outline: 2px solid #4F46E5; background-color: #e0e7ff; color: #111827; }
        .dark td[contenteditable="true"]:focus { background-color: #374151; color: white; }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 dark:bg-darkbg dark:text-gray-100 font-sans min-h-screen flex flex-col">

    <!-- TOP BANNER SPOT -->
    <div class="w-full bg-gray-200 dark:bg-gray-800 text-center text-xs py-2 text-gray-500 no-print">
        [ Top Banner Ad Placement ]
    </div>

    <!-- Navigation Bar -->
    <nav class="sticky top-0 z-50 bg-white dark:bg-darkcard shadow-md px-4 py-3 no-print">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="flex items-center cursor-pointer" onclick="showSection('home')">
                <i class="fa-solid fa-flask text-primary text-2xl mr-2"></i>
                <h1 class="text-xl font-bold tracking-wide text-primary">Student Lab</h1>
            </div>
            <div class="hidden md:block relative w-1/3">
                <input type="text" id="searchBar" placeholder="Search tools..." onkeyup="searchTools()" class="w-full pl-10 pr-4 py-2 rounded-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 focus:outline-none focus:border-primary">
                <i class="fa-solid fa-search absolute left-4 top-3 text-gray-400"></i>
            </div>
            <div class="flex items-center space-x-4">
                <button onclick="showSection('home')" class="text-gray-600 dark:text-gray-300 hover:text-primary transition font-bold hidden md:block">Home</button>
                <button onclick="toggleDarkMode()" class="text-gray-600 dark:text-gray-300 hover:text-primary transition">
                    <i id="theme-icon" class="fa-solid fa-moon text-xl"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow max-w-6xl mx-auto w-full px-4 py-8">
        
        <!-- Social Share Banner -->
        <div class="flex justify-end space-x-2 mb-6 text-sm no-print">
            <button onclick="shareLink('whatsapp')" class="bg-green-500 text-white px-3 py-1 rounded shadow hover:bg-green-600"><i class="fa-brands fa-whatsapp"></i> Share</button>
            <button onclick="shareLink('copy')" class="bg-gray-600 text-white px-3 py-1 rounded shadow hover:bg-gray-700"><i class="fa-solid fa-link"></i> Copy</button>
        </div>

        <!-- ================= HOME SECTION ================= -->
        <section id="home" class="block no-print">
            <h2 class="text-2xl font-bold mb-6">All Student Tools</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="tools-grid">
                
                <!-- AI MCQ Maker -->
                <div class="tool-card bg-gradient-to-br from-blue-500 to-cyan-500 text-white p-5 rounded-xl shadow cursor-pointer relative overflow-hidden" onclick="showSection('mcq-maker')">
                    <i class="fa-solid fa-list-check text-2xl mb-2"></i>
                    <h3 class="text-lg font-bold mb-1">AI Notes Test</h3>
                    <p class="text-blue-100 text-xs">Convert notes to MCQs</p>
                </div>

                <!-- Schedule Maker -->
                <div class="tool-card bg-white dark:bg-darkcard p-5 rounded-xl shadow cursor-pointer border-t-4 border-indigo-500" onclick="showSection('schedule')">
                    <i class="fa-solid fa-calendar-days text-2xl text-indigo-500 mb-2"></i>
                    <h3 class="text-lg font-bold mb-1">Schedule Maker</h3>
                    <p class="text-gray-500 text-xs">Daily/Weekly Timetable</p>
                </div>

                <!-- CGPA -->
                <div class="tool-card bg-white dark:bg-darkcard p-5 rounded-xl shadow cursor-pointer border-t-4 border-yellow-500" onclick="showSection('cgpa')">
                    <i class="fa-solid fa-graduation-cap text-2xl text-yellow-500 mb-2"></i>
                    <h3 class="text-lg font-bold mb-1">Pro CGPA Calc</h3>
                    <p class="text-gray-500 text-xs">GPA & Overall CGPA</p>
                </div>

                <!-- Exam Countdown -->
                <div class="tool-card bg-white dark:bg-darkcard p-5 rounded-xl shadow cursor-pointer border-t-4 border-red-500" onclick="showSection('countdown')">
                    <i class="fa-solid fa-hourglass-half text-2xl text-red-500 mb-2"></i>
                    <h3 class="text-lg font-bold mb-1">Exam Countdown</h3>
                    <p class="text-gray-500 text-xs">Track exam days left</p>
                </div>

                <!-- Pomodoro Timer -->
                <div class="tool-card bg-white dark:bg-darkcard p-5 rounded-xl shadow cursor-pointer border-t-4 border-primary" onclick="showSection('timer')">
                    <i class="fa-solid fa-stopwatch text-2xl text-primary mb-2"></i>
                    <h3 class="text-lg font-bold mb-1">Study Timer</h3>
                    <p class="text-gray-500 text-xs">Pomodoro & Daily Tracker</p>
                </div>

                <!-- Notes Maker -->
                <div class="tool-card bg-white dark:bg-darkcard p-5 rounded-xl shadow cursor-pointer border-t-4 border-green-500" onclick="showSection('notes')">
                    <i class="fa-solid fa-book-open text-2xl text-green-500 mb-2"></i>
                    <h3 class="text-lg font-bold mb-1">Notes Maker</h3>
                    <p class="text-gray-500 text-xs">Auto-save & Download</p>
                </div>

                <!-- Unit & Word Converter -->
                <div class="tool-card bg-white dark:bg-darkcard p-5 rounded-xl shadow cursor-pointer border-t-4 border-pink-500" onclick="showSection('converter')">
                    <i class="fa-solid fa-calculator text-2xl text-pink-500 mb-2"></i>
                    <h3 class="text-lg font-bold mb-1">Converter & Words</h3>
                    <p class="text-gray-500 text-xs">Units, Words, Read time</p>
                </div>

                <!-- PDF Tools -->
                <div class="tool-card bg-white dark:bg-darkcard p-5 rounded-xl shadow cursor-pointer border-t-4 border-purple-500" onclick="showSection('pdf-tools')">
                    <i class="fa-solid fa-file-pdf text-2xl text-purple-500 mb-2"></i>
                    <h3 class="text-lg font-bold mb-1">PDF Tools</h3>
                    <p class="text-gray-500 text-xs">Merge, Split, Compress</p>
                </div>

            </div>
            
            <!-- Blog Section (Requested in Prompt 1) -->
            <div class="mt-10 bg-primary text-white rounded-xl p-6 flex flex-col md:flex-row items-center justify-between">
                <div>
                    <h3 class="text-xl font-bold mb-1">Study Tips Blog</h3>
                    <p class="text-sm text-blue-100">Read latest tips to score A+ and manage time efficiently.</p>
                </div>
                <button class="mt-4 md:mt-0 bg-white text-primary font-bold px-6 py-2 rounded-full hover:bg-gray-100 text-sm">Read Blog</button>
            </div>
        </section>

        <!-- MIDDLE BANNER SPOT -->
        <div class="w-full bg-gray-200 dark:bg-gray-800 text-center text-xs py-2 text-gray-500 my-6 no-print">[ Middle Banner Ad Placement ]</div>

        <!-- ================= TOOLS SECTIONS ================= -->

        <!-- 1. AI MCQ MAKER -->
        <section id="mcq-maker" class="hide w-full max-w-4xl mx-auto">
            <h2 class="text-3xl font-bold mb-2"><i class="fa-solid fa-list-check text-cyan-500"></i> AI Notes Test Maker</h2>
            
            <div id="api-key-box" class="bg-yellow-50 dark:bg-yellow-900/30 p-4 border rounded mb-4">
                <p class="text-sm text-yellow-800 dark:text-yellow-400 mb-2">Save free Google Gemini API Key to use AI tools locally.</p>
                <div class="flex"><input type="password" id="gemini-api-key" placeholder="API Key..." class="p-2 border rounded w-full text-sm dark:bg-gray-700"><button onclick="saveApiKey()" class="bg-primary text-white px-4 py-2 rounded ml-2">Save</button></div>
            </div>

            <div id="mcq-setup-area" class="bg-white dark:bg-darkcard p-6 rounded-xl shadow">
                <label class="font-bold block mb-2">Paste Study Notes:</label>
                <textarea id="mcq-notes" class="w-full h-32 p-3 border rounded-lg focus:outline-none dark:bg-gray-700 mb-4"></textarea>
                <div class="flex gap-4">
                    <select id="mcq-count" class="p-2 border rounded dark:bg-gray-700"><option value="3">3 Qs</option><option value="5" selected>5 Qs</option></select>
                    <button onclick="generateQuiz()" id="generate-quiz-btn" class="bg-cyan-500 text-white px-6 py-2 rounded font-bold hover:bg-cyan-600 w-full">Generate Quiz</button>
                </div>
                <div id="mcq-loader" class="hidden mt-4 flex items-center text-cyan-600 font-bold"><div class="loader mr-3"></div> AI is creating your test...</div>
            </div>

            <div id="quiz-area" class="hidden bg-white dark:bg-darkcard p-6 rounded-xl shadow">
                <div id="quiz-questions-container" class="space-y-6 mb-6"></div>
                <button onclick="submitQuiz()" id="submit-quiz-btn" class="w-full bg-green-500 text-white py-3 rounded-xl font-bold">Submit Test</button>
                <div id="quiz-results" class="hidden mt-6 text-center p-6 bg-blue-50 dark:bg-blue-900/30 rounded border border-blue-500">
                    <h2 class="text-3xl font-bold">Score: <span id="quiz-score-display"></span></h2>
                    <button onclick="resetQuiz()" class="mt-4 border border-blue-500 text-blue-500 px-4 py-1 rounded">Create New</button>
                </div>
            </div>
        </section>

        <!-- 2. SCHEDULE MAKER (Weekly & Color Coding) -->
        <section id="schedule" class="hide w-full max-w-5xl mx-auto">
            <div class="flex justify-between items-center mb-4 no-print">
                <h2 class="text-3xl font-bold"><i class="fa-solid fa-calendar-days text-indigo-500"></i> Class Schedule Maker</h2>
                <div class="space-x-2">
                    <button onclick="generateRandomSchedule()" class="bg-purple-500 text-white px-3 py-1 rounded shadow text-sm hover:bg-purple-600"><i class="fa-solid fa-dice"></i> Randomize</button>
                    <button onclick="window.print()" class="bg-indigo-600 text-white px-3 py-1 rounded shadow text-sm hover:bg-indigo-700"><i class="fa-solid fa-print"></i> Print / PDF</button>
                </div>
            </div>
            <p class="text-sm text-gray-500 mb-4 no-print">Click any cell to type. Auto-saves to your browser! Use standard color names like "red", "blue", "green" inside brackets e.g., <b>Math [blue]</b> to color code.</p>

            <div class="overflow-x-auto bg-white dark:bg-darkcard p-4 rounded-xl shadow">
                <table class="w-full text-center border-collapse">
                    <thead>
                        <tr class="bg-gray-200 dark:bg-gray-700 text-sm">
                            <th class="border p-2 w-24">Time</th>
                            <th class="border p-2">Mon</th><th class="border p-2">Tue</th><th class="border p-2">Wed</th>
                            <th class="border p-2">Thu</th><th class="border p-2">Fri</th><th class="border p-2">Sat</th>
                        </tr>
                    </thead>
                    <tbody id="schedule-body">
                        <!-- JS renders rows -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 3. EXAM COUNTDOWN -->
        <section id="countdown" class="hide w-full max-w-2xl mx-auto text-center">
            <h2 class="text-3xl font-bold mb-6"><i class="fa-solid fa-hourglass-half text-red-500"></i> Exam Countdown</h2>
            <div class="bg-white dark:bg-darkcard p-6 rounded-xl shadow mb-6">
                <input type="text" id="exam-name" placeholder="Exam Name (e.g. Finals)" class="w-full p-2 mb-4 border rounded dark:bg-gray-700">
                <input type="date" id="exam-date" class="w-full p-2 mb-4 border rounded dark:bg-gray-700 text-gray-500">
                <button onclick="saveExam()" class="bg-red-500 text-white px-6 py-2 rounded font-bold hover:bg-red-600 w-full">Start Timer</button>
            </div>
            
            <div id="countdown-display" class="hidden bg-red-50 dark:bg-red-900/20 p-8 rounded-xl border border-red-500">
                <h3 id="c-name" class="text-2xl font-bold text-red-700 dark:text-red-300 mb-4"></h3>
                <div class="grid grid-cols-3 gap-4 text-4xl font-black text-red-600 dark:text-red-400">
                    <div><span id="c-days">0</span><div class="text-sm font-normal mt-1 text-gray-600">Days</div></div>
                    <div><span id="c-hours">0</span><div class="text-sm font-normal mt-1 text-gray-600">Hours</div></div>
                    <div><span id="c-mins">0</span><div class="text-sm font-normal mt-1 text-gray-600">Minutes</div></div>
                </div>
            </div>
        </section>

        <!-- 4. POMODORO TIMER & TRACKER -->
        <section id="timer" class="hide flex flex-col items-center py-6">
            <h2 class="text-3xl font-bold mb-6"><i class="fa-solid fa-stopwatch text-primary"></i> Study Timer</h2>
            
            <div class="bg-white dark:bg-darkcard p-8 rounded-full shadow-2xl border-8 border-primary w-64 h-64 flex flex-col items-center justify-center mb-6">
                <span id="time-display" class="text-5xl font-mono font-bold">25:00</span>
            </div>
            <div class="space-x-2 mb-6 text-sm">
                <button onclick="startTimer()" class="bg-primary text-white px-5 py-2 rounded shadow hover:bg-blue-700">Start</button>
                <button onclick="pauseTimer()" class="bg-yellow-500 text-white px-5 py-2 rounded shadow hover:bg-yellow-600">Pause</button>
                <button onclick="resetTimer()" class="bg-red-500 text-white px-5 py-2 rounded shadow hover:bg-red-600">Reset</button>
            </div>
            
            <div class="bg-gray-200 dark:bg-gray-800 p-4 rounded-xl w-full max-w-sm text-center">
                <h4 class="font-bold mb-2">Daily Study Tracker</h4>
                <p class="text-sm text-gray-600 dark:text-gray-400">Total Focused Today: <span id="daily-tracked" class="font-bold text-primary text-lg">0</span> mins</p>
            </div>
        </section>

        <!-- 5. UNIT & WORD CONVERTER -->
        <section id="converter" class="hide w-full max-w-4xl mx-auto">
            <h2 class="text-3xl font-bold mb-6"><i class="fa-solid fa-calculator text-pink-500"></i> Converter & Tools</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Unit Converter -->
                <div class="bg-white dark:bg-darkcard p-6 rounded-xl shadow">
                    <h3 class="font-bold mb-4 border-b pb-2">Length Converter</h3>
                    <div class="flex items-center space-x-2 mb-4">
                        <input type="number" id="km-val" placeholder="Kilometers" oninput="conv('km')" class="w-1/2 p-2 border rounded dark:bg-gray-700">
                        <span>=</span>
                        <input type="number" id="mi-val" placeholder="Miles" oninput="conv('mi')" class="w-1/2 p-2 border rounded dark:bg-gray-700">
                    </div>
                    <h3 class="font-bold mb-4 border-b pb-2">Weight Converter</h3>
                    <div class="flex items-center space-x-2">
                        <input type="number" id="kg-val" placeholder="Kilograms" oninput="conv('kg')" class="w-1/2 p-2 border rounded dark:bg-gray-700">
                        <span>=</span>
                        <input type="number" id="lb-val" placeholder="Pounds" oninput="conv('lb')" class="w-1/2 p-2 border rounded dark:bg-gray-700">
                    </div>
                </div>

                <!-- Word Counter -->
                <div class="bg-white dark:bg-darkcard p-6 rounded-xl shadow">
                    <h3 class="font-bold mb-4 border-b pb-2">Word Counter</h3>
                    <textarea id="word-area" oninput="updateWordCount()" class="w-full h-24 p-2 border rounded dark:bg-gray-700 mb-2" placeholder="Type or paste text..."></textarea>
                    <div class="flex justify-between text-sm font-bold text-pink-600 dark:text-pink-400">
                        <span>Words: <span id="w-count">0</span></span>
                        <span>Chars: <span id="c-count">0</span></span>
                        <span>Read Time: <span id="r-time">0m</span></span>
                    </div>
                </div>
            </div>
        </section>

        <!-- 6. PDF TOOLS (Placeholder UI with Ad Placement) -->
        <section id="pdf-tools" class="hide w-full max-w-4xl mx-auto text-center">
            <h2 class="text-3xl font-bold mb-6"><i class="fa-solid fa-file-pdf text-purple-500"></i> PDF Tools Suite</h2>
            <p class="text-gray-500 mb-6">Select a tool to process your PDFs directly in your browser securely.</p>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <button class="bg-white dark:bg-darkcard p-4 rounded shadow border hover:border-purple-500" onclick="alert('Merge PDF tool selected! (Attach JS Library here)')"><i class="fa-solid fa-layer-group block text-2xl mb-2 text-purple-500"></i> Merge PDF</button>
                <button class="bg-white dark:bg-darkcard p-4 rounded shadow border hover:border-purple-500" onclick="alert('Split PDF tool selected!')"><i class="fa-solid fa-cut block text-2xl mb-2 text-purple-500"></i> Split PDF</button>
                <button class="bg-white dark:bg-darkcard p-4 rounded shadow border hover:border-purple-500" onclick="alert('Compress PDF tool selected!')"><i class="fa-solid fa-compress block text-2xl mb
                                   <button class="bg-white dark:bg-darkcard p-4 rounded shadow border hover:border-purple-500" onclick="alert('PDF to Image tool selected!')"><i class="fa-solid fa-image block text-2xl mb-2 text-purple-500"></i> to Image</button>
            </div>

            <!-- Ad Placement near PDF Download -->
            <div class="bg-gray-200 dark:bg-gray-800 text-xs py-4 text-gray-500 rounded border border-dashed border-gray-400">[ Ad Placement (Monetag/Adsense) Near PDF Upload/Download Buttons ]
            </div>
        </section>

        <!-- (Keeping CGPA and Notes hidden structures clean) -->
        <section id="cgpa" class="hide max-w-2xl mx-auto"><h2 class="text-3xl font-bold mb-4">CGPA Calculator</h2><p class="text-sm mb-4">Calculate semester GPA.</p><div id="subject-rows" class="space-y-2 mb-4"></div><button onclick="addSubjectRow()" class="text-primary text-sm mb-4">+ Add Subject</button><button onclick="calculateCGPA()" class="w-full bg-yellow-500 text-white py-2 rounded font-bold">Calculate</button><div id="final-gpa" class="mt-4 text-2xl font-bold text-center"></div></section>
        
        <section id="notes" class="hide max-w-4xl mx-auto"><h2 class="text-3xl font-bold mb-4">Notes Maker</h2><textarea id="note-area" oninput="saveNote()" class="w-full h-64 p-4 border rounded dark:bg-gray-700 mb-4" placeholder="Type... auto-saves."></textarea><div class="flex justify-between items-center"><button onclick="downloadNote()" class="bg-green-500 text-white px-6 py-2 rounded"><i class="fa-solid fa-download"></i> Download .TXT</button><div class="text-xs text-gray-400">[ Ad Near Download ]</div></div></section>

    </main>

    <!-- BOTTOM BANNER SPOT -->
    <div class="w-full bg-gray-200 dark:bg-gray-800 text-center text-xs py-2 text-gray-500 mt-auto no-print">[ Bottom Banner Ad Placement ]</div>

    <!-- Javascript -->
    <script>
        // --- 1. Navigation & Setup ---
        const sections =['home', 'mcq-maker', 'schedule', 'countdown', 'timer', 'converter', 'pdf-tools', 'cgpa', 'notes'];
        function showSection(id) {
            sections.forEach(s => document.getElementById(s).classList.add('hide'));
            document.getElementById(id).classList.remove('hide');
            window.scrollTo(0,0);
        }
        function searchTools() {
            let filter = document.getElementById('searchBar').value.toLowerCase();
            document.querySelectorAll('.tool-card').forEach(card => {
                card.style.display = card.innerText.toLowerCase().includes(filter) ? "" : "none";
            });
        }
        function toggleDarkMode() { document.documentElement.classList.toggle('dark'); }
        function shareLink(type) { alert(type === 'copy' ? "Link Copied!" : "Opening Share..."); }

        // --- 2. Schedule Maker Logic (Editable Table + Color Parse) ---
        const scheduleBody = document.getElementById('schedule-body');
        const times =["08:00 AM", "09:00 AM", "10:00 AM", "11:00 AM", "12:00 PM", "01:00 PM", "02:00 PM", "03:00 PM"];
        
        function renderSchedule() {
            scheduleBody.innerHTML = "";
            let savedData = JSON.parse(localStorage.getItem('schedule_data')) || {};
            
            times.forEach((time, rIdx) => {
                let row = `<tr><td class="border p-2 font-bold text-xs text-gray-500">${time}</td>`;
                for(let cIdx=0; cIdx<6; cIdx++) {
                    let cellId = `c_${rIdx}_${cIdx}`;
                    let content = savedData[cellId] || "";
                    // Parse color e.g. "Math [blue]"
                    let bgColor = "transparent"; let textColor = "";
                    if(content.includes('[red]')) { bgColor="#fee2e2"; textColor="#991b1b"; content = content.replace('[red]',''); }
                    else if(content.includes('[blue]')) { bgColor="#dbeafe"; textColor="#1e40af"; content = content.replace('[blue]',''); }
                    else if(content.includes('[green]')) { bgColor="#d1fae5"; textColor="#065f46"; content = content.replace('[green]',''); }
                    
                    row += `<td id="${cellId}" contenteditable="true" onblur="saveSchedule()" class="border p-2 text-sm focus:outline-none transition" style="background-color:${bgColor}; color:${textColor}">${content}</td>`;
                }
                row += `</tr>`;
                scheduleBody.innerHTML += row;
            });
        }
        function saveSchedule() {
            let data = {};
            document.querySelectorAll('td[contenteditable="true"]').forEach(td => {
                data[td.id] = td.innerText;
            });
            localStorage.setItem('schedule_data', JSON.stringify(data));
            renderSchedule(); // Re-render to apply color tags immediately
        }
        function generateRandomSchedule() {
            let subjects = ["Math [blue]", "Physics [red]", "Break [green]", "English", "History [blue]"];
            let data = {};
            for(let r=0; r<times.length; r++){
                for(let c=0; c<6; c++){
                    if(Math.random() > 0.4) data[`c_${r}_${c}`] = subjects[Math.floor(Math.random()*subjects.length)];
                }
            }
            localStorage.setItem('schedule_data', JSON.stringify(data));
            renderSchedule();
        }
        renderSchedule();

        // --- 3. Exam Countdown Logic ---
        let countInterval;
        function loadExam() {
            let data = JSON.parse(localStorage.getItem('exam_data'));
            if(data) { document.getElementById('exam-name').value = data.name; document.getElementById('exam-date').value = data.date; startCountdown(data.name, data.date); }
        }
        function saveExam() {
            let n = document.getElementById('exam-name').value; let d = document.getElementById('exam-date').value;
            if(!n || !d) return alert("Enter details");
            localStorage.setItem('exam_data', JSON.stringify({name:n, date:d}));
            startCountdown(n, d);
        }
        function startCountdown(name, dateStr) {
            clearInterval(countInterval);
            document.getElementById('countdown-display').classList.remove('hidden');
            document.getElementById('c-name').innerText = name + " Exam";
            let target = new Date(dateStr).getTime();
            
            countInterval = setInterval(() => {
                let now = new Date().getTime(); let dist = target - now;
                if(dist < 0) { clearInterval(countInterval); document.getElementById('c-days').innerText = "0"; return; }
                document.getElementById('c-days').innerText = Math.floor(dist / (1000 * 60 * 60 * 24));
                document.getElementById('c-hours').innerText = Math.floor((dist % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                document.getElementById('c-mins').innerText = Math.floor((dist % (1000 * 60 * 60)) / (1000 * 60));
            }, 1000);
        }
        loadExam();

        // --- 4. Timer & Daily Tracker ---
        let timerInt; let tLeft = 25*60;
        let trackedMins = parseInt(localStorage.getItem('tracked_mins')) || 0;
        document.getElementById('daily-tracked').innerText = trackedMins;

        function updateT() {
            let m=Math.floor(tLeft/60); let s=tLeft%60;
            document.getElementById('time-display').innerText = `${m<10?'0':''}${m}:${s<10?'0':''}${s}`;
        }
        function startTimer() {
            clearInterval(timerInt);
            timerInt = setInterval(() => {
                if(tLeft > 0) { tLeft--; updateT(); } 
                else { 
                    clearInterval(timerInt); alert("Session Done!"); 
                    trackedMins += 25; localStorage.setItem('tracked_mins', trackedMins);
                    document.getElementById('daily-tracked').innerText = trackedMins;
                }
            }, 1000);
        }
        function pauseTimer() { clearInterval(timerInt); }
        function resetTimer() { clearInterval(timerInt); tLeft=25*60; updateT(); }

        // --- 5. Unit & Word Converter ---
        function conv(type) {
            let km=document.getElementById('km-val'), mi=document.getElementById('mi-val');
            let kg=document.getElementById('kg-val'), lb=document.getElementById('lb-val');
            if(type==='km') mi.value = (km.value * 0.621371).toFixed(2);
            if(type==='mi') km.value = (mi.value * 1.60934).toFixed(2);
            if(type==='kg') lb.value = (kg.value * 2.20462).toFixed(2);
            if(type==='lb') kg.value = (lb.value * 0.453592).toFixed(2);
        }
        function updateWordCount() {
            let text = document.getElementById('word-area').value;
            let words = text.match(/\b[-?(\w+)?]+\b/gi);
            let wc = words ? words.length : 0;
            document.getElementById('w-count').innerText = wc;
            document.getElementById('c-count').innerText = text.length;
            document.getElementById('r-time').innerText = Math.ceil(wc/200)+"m";
        }

        // --- 6. Quick CGPA & Notes Setup ---
        function addSubjectRow() {
            let html = `<div class="flex space-x-2"><input type="number" placeholder="Credits" class="w-1/2 p-2 border rounded cr"><input type="number" placeholder="GPA(1-4)" class="w-1/2 p-2 border rounded gp"></div>`;
            document.getElementById('subject-rows').insertAdjacentHTML('beforeend', html);
        }
        for(let i=0;i<3;i++) addSubjectRow();
        function calculateCGPA() {
            let tCr=0, tGp=0;
            document.querySelectorAll('#subject-rows .flex').forEach(r => {
                let c=parseFloat(r.querySelector('.cr').value), g=parseFloat(r.querySelector('.gp').value);
                if(c&&g){ tCr+=c; tGp+=c*g; }
            });
            document.getElementById('final-gpa').innerText = tCr ? "GPA: " + (tGp/tCr).toFixed(2) : "Enter Data!";
        }
        
        const noteArea = document.getElementById('note-area');
        noteArea.value = localStorage.getItem('notes') || "";
        function saveNote() { localStorage.setItem('notes', noteArea.value); }
        function downloadNote() {
            let blob = new Blob([noteArea.value], {type:'text/plain'});
            let a = document.createElement('a'); a.download="Notes.txt"; a.href=URL.createObjectURL(blob); a.click();
        }

        // --- 7. AI MCQ TEST MAKER (Gemini API) ---
        let savedKey = localStorage.getItem('gemini_api_key');
        if(savedKey) document.getElementById('api-key-box').style.display='none';
        function saveApiKey() {
            let k = document.getElementById('gemini-api-key').value;
            if(k){ localStorage.setItem('gemini_api_key', k); savedKey=k; document.getElementById('api-key-box').style.display='none'; }
        }

        let quizData =[];
        async function generateQuiz() {
            let text = document.getElementById('mcq-notes').value;
            let count = document.getElementById('mcq-count').value;
            if(!savedKey) return alert("Save API key first!"); if(text.length<30) return alert("Paste more notes!");
            
            document.getElementById('mcq-loader').classList.remove('hidden');
            let prompt = `Make ${count} multiple choice questions from this text. Output ONLY valid JSON array like: [{"question":"Q1?", "options":["A","B","C","D"], "answer":"A"}]. Text: ${text}`;
            
            try {
                let res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${savedKey}`, {
                    method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({contents:[{parts:[{text:prompt}]}]})
                });
                let data = await res.json();
                let cleanJson = data.candidates[0].content.parts[0].text.replace(/```json/gi,'').replace(/```/g,'').trim();
                quizData = JSON.parse(cleanJson);
                renderQuiz();
            } catch(e) { alert("Error: " + e.message); }
            document.getElementById('mcq-loader').classList.add('hidden');
        }

        function renderQuiz() {
            document.getElementById('mcq-setup-area').classList.add('hidden');
            document.getElementById('quiz-area').classList.remove('hidden');
            let box = document.getElementById('quiz-questions-container'); box.innerHTML = "";
            quizData.forEach((q, i) => {
                let opts = q.options.map(opt => `<label class="block p-2 border rounded mb-2 opt-${i}"><input type="radio" name="q${i}" value="${opt}" class="mr-2">${opt}</label>`).join('');
                box.innerHTML += `<div class="p-4 bg-gray-50 border rounded mb-4"><h4 class="font-bold mb-2">Q${i+1}: ${q.question}</h4>${opts}</div>`;
            });
        }

        function submitQuiz() {
            let score = 0;
            quizData.forEach((q, i) => {
                let sel = document.querySelector(`input[name="q${i}"]:checked`);
                document.querySelectorAll(`.opt-${i}`).forEach(lbl => {
                    let r = lbl.querySelector('input'); r.disabled = true;
                    if(r.value === q.answer) lbl.classList.add('correct-answer');
                    if(sel && r === sel && r.value !== q.answer) lbl.classList.add('wrong-answer');
                });
                if(sel && sel.value === q.answer) score++;
            });
            document.getElementById('submit-quiz-btn').classList.add('hidden');
            document.getElementById('quiz-results').classList.remove('hidden');
            document.getElementById('quiz-score-display').innerText = `${score} / ${quizData.length}`;
        }
        function resetQuiz() {
            document.getElementById('mcq-setup-area').classList.remove('hidden');
            document.getElementById('quiz-area').classList.add('hidden');
            document.getElementById('quiz-results').classList.add('hidden');
            document.getElementById('submit-quiz-btn').classList.remove('hidden');
        }
    </script>
</body>
    </html>                                                                                                                                            
